---
name: STM32N6 NPU Benchmark
device: stm32n6
chip: stm32n6
timeout: 120

steps:
  - sram_boot:
      binary: ~/ST/stedgeai/4.0/Projects/STM32N6570-DK/Applications/NPU_Validation/armgcc/build/N6-Nucleo/Project.bin
      load_address: "0x34000000"
      exclusive_usb: true
      probe_chip: STM32N657
      probe_selector: "0483:3754"
      gdb_path: /Users/shane/zephyr-sdk-0.17.0/arm-zephyr-eabi/bin/arm-zephyr-eabi-gdb
      cubeprogrammer: /Applications/STMicroelectronics/STM32Cube/STM32CubeProgrammer/STM32CubeProgrammer.app/Contents/Resources/bin/STM32_Programmer_CLI
  - wait:
      pattern: "=== STM32N6 NPU Benchmark"
      timeout: 10
  - wait:
      pattern: "PMU profiler initialized"
      timeout: 5
  - bench_capture:
      pattern: "\\[ML_BENCH\\] model=person_detect backend=npu"
      timeout: 30
      expect:
        cycles_gt: 0
        time_us_gt: 0
        time_us_lt: 10000
  - bench_done:
      pattern: "\\[ML_BENCH_DONE\\] board=nucleo_n657x0_q"
      timeout: 10
